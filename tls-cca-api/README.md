# TLS CCA API

API backend for the Auto Debt Management system, built with Django and Django REST Framework. It provides a robust backend with role-based access control (RBAC) for managing users, customers, sales, and receivables.

## Features

- **User Management:** Secure user registration, authentication (login/logout), and profile management with JWT.
- **Role-Based Access Control (RBAC):** Fine-grained permission system to control access to different API endpoints based on user roles.
- **Customer Relationship Management (CRM):** Manage customer data and portfolios.
- **Sales Management:** Track credit sales.
- **Receivables Management:** Manage debts and recovery processes.
- **Reporting:** Generate reports on various aspects of the system.
- **API Documentation:** Auto-generated API documentation using `drf-spectacular`.

## Getting Started

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes.

### Prerequisites

- Python 3.12+
- Poetry for dependency management

### Installation

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/Thrylos77/auto-debt-management.git
    cd auto-debt-management/tls-cca-api
    ```

2.  **Install dependencies using Poetry:**

    ```bash
    poetry install
    ```

3.  **Create a `.env` file:**

    Copy the `.env.example` to a new file named `.env`.

    ```bash
    cp .env.example .env
    ```

    Update the `.env` file with your specific settings, such as `DJANGO_SECRET_KEY`, and email credentials.

4.  **Apply database migrations:**

    ```bash
    poetry run python manage.py migrate
    ```

5.  **Create a superuser:**

    ```bash
    poetry run python manage.py createsuperuser
    ```

6.  **Seed initial data (optional but recommended):**

    ```bash
    poetry run python manage.py seed_rbac_v2
    ```

## Running the Application

To run the development server, use the following command:

```bash
poetry run python manage.py runserver
```

The API will be available at `http://127.0.0.1:8000/`.

## Running Tests

To run the test suite, use `pytest`. The following command will run all tests and provide a coverage report:

```bash
poetry run pytest
```

## API Documentation

The API documentation is automatically generated by `drf-spectacular`. Once the server is running, you can access the documentation at:

-   **Swagger UI:** `http://127.0.0.1:8000/api/schema/swagger-ui/`
-   **Redoc:** `http://127.0.0.1:8000/api/schema/redoc/`

## Built With

-   [Django](https://www.djangoproject.com/) - The web framework for perfectionists with deadlines.
-   [Django REST Framework](https://www.django-rest-framework.org/) - A powerful and flexible toolkit for building Web APIs.
-   [Poetry](https://python-poetry.org/) - Python dependency management and packaging made easy.
-   [SQLite](https://www.sqlite.org/index.html) - A C-language library that implements a small, fast, self-contained, high-reliability, full-featured, SQL database engine.
-   [DRF Spectacular](https://drf-spectacular.readthedocs.io/en/latest/) - Sane and sensible OpenAPI 3 schema generation for Django REST framework.
-   [Simple JWT](https://django-rest-framework-simplejwt.readthedocs.io/en/latest/) - A JSON Web Token authentication plugin for the Django REST Framework.
